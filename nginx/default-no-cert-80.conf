
  map $http_upgrade $connection_upgrade {
    default upgrade;
    ''      close;
  }

    server {
      listen                80 default_server;
      listen                [::]:80 default_server;
      # listen                8081;
      server_name           hhear-ontlgy-dev3.mssm.edu;
      
      access_log            /var/log/nginx/shinyproxy.access.log;
      error_log             /var/log/nginx/shinyproxy.error.log error;

      ssl_protocols TLSv1 TLSv1.1 TLSv1.2;

      # ssl_certificate       /etc/ssl/certs/mssm.crt;
      # ssl_certificate_key   /etc/ssl/private/mssm.key;
      # ssl_password_file     /etc/ssl/ssl_passwords.txt;


      location / {
           proxy_pass          http://hhear-ontlgy-dev3.mssm.edu:9000/;

           proxy_http_version 1.1;
           proxy_set_header Upgrade $http_upgrade;
           proxy_set_header Connection "upgrade";
           proxy_read_timeout 600s;

           proxy_redirect    off;
           proxy_set_header  Host              $http_host;
           proxy_set_header  X-Real-IP         $remote_addr;
           proxy_set_header  X-Forwarded-For   $proxy_add_x_forwarded_for;
           proxy_set_header  X-Forwarded-Proto $scheme;
      }

      location /hadatac/ {
           proxy_pass          http://hhear-ontlgy-dev3.mssm.edu:9000;

           proxy_http_version 1.1;
           proxy_set_header Upgrade $http_upgrade;
           proxy_set_header Connection "upgrade";
           proxy_read_timeout 600s;

           proxy_redirect    off;
           proxy_set_header  Host              $http_host;
           proxy_set_header  X-Real-IP         $remote_addr;
           proxy_set_header  X-Forwarded-For   $proxy_add_x_forwarded_for;
           proxy_set_header  X-Forwarded-Proto $scheme;
      }


      location /solr/ {
           proxy_pass          http://hhear-ontlgy-dev3.mssm.edu:8983;

           proxy_http_version 1.1;
           proxy_set_header Upgrade $http_upgrade;
           proxy_set_header Connection "upgrade";
            proxy_read_timeout 600s;

           proxy_redirect    off;
           proxy_set_header  Host              $http_host;
           proxy_set_header  X-Real-IP         $remote_addr;
           proxy_set_header  X-Forwarded-For   $proxy_add_x_forwarded_for;
           proxy_set_header  X-Forwarded-Proto $scheme;
      }

     location /solr-home/ {
           proxy_pass          http://hhear-ontlgy-dev3.mssm.edu:8983/solr/#/login;

           proxy_http_version 1.1;
           proxy_set_header Upgrade $http_upgrade;
           proxy_set_header Connection "upgrade";
            proxy_read_timeout 600s;

           proxy_redirect    off;
           proxy_set_header  Host              $http_host;
           proxy_set_header  X-Real-IP         $remote_addr;
           proxy_set_header  X-Forwarded-For   $proxy_add_x_forwarded_for;
           proxy_set_header  X-Forwarded-Proto $scheme;
      }



      location /shinyapps/ {
           proxy_pass          http://hhear-ontlgy-dev3.mssm.edu:8081/;

           proxy_http_version 1.1;
           proxy_set_header Upgrade $http_upgrade;
           proxy_set_header Connection "upgrade";
           proxy_read_timeout 600s;

           proxy_redirect    off;
           proxy_set_header  Host              $http_host;
           proxy_set_header  X-Real-IP         $remote_addr;
           proxy_set_header  X-Forwarded-For   $proxy_add_x_forwarded_for;
           proxy_set_header  X-Forwarded-Proto $scheme;
      }


      location /yasgui/ {
           proxy_pass          http://hhear-ontlgy-dev3.mssm.edu:8888/;

           proxy_http_version 1.1;
           proxy_set_header Upgrade $http_upgrade;
           proxy_set_header Connection "upgrade";
           proxy_read_timeout 600s;

           proxy_redirect    off;
           proxy_set_header  Host              $http_host;
           proxy_set_header  X-Real-IP         $remote_addr;
           proxy_set_header  X-Forwarded-For   $proxy_add_x_forwarded_for;
           proxy_set_header  X-Forwarded-Proto $scheme;
       }


    }

